{"version":3,"file":"component---src-pages-garden-debounce-and-throttle-tsx-3f92b36550541be0ddd8.js","mappings":"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","sources":["webpack://portfolio/./src/components/BookCard/index.tsx","webpack://portfolio/./src/pages/garden/debounce-and-throttle.tsx","webpack://portfolio/./src/helpers/throttleFunction.ts"],"sourcesContent":["import React from \"react\";\r\n\r\ntype WorksType = {\r\n\twork: {\r\n\t\tsubtitle?: string;\r\n\t\tdescription?: { type: string; value: string };\r\n\t\ttitle?: string;\r\n\t\tcovers?: string[];\r\n\t\tfirst_publish_date?: string;\r\n\t\tauthors?: { type: { key: string }; author: { key: string } }[];\r\n\t\tdewey_number: string[];\r\n\t\tsubjects: string[];\r\n\t\tcreated: { type: string; value: string };\r\n\t};\r\n};\r\n\r\nexport const BookCard = ({ work }: WorksType) => {\r\n\tconst covers = work.covers ?? null;\r\n\treturn (\r\n\t\t<div className=\"book__card\">\r\n\t\t\t<p>\r\n\t\t\t\tTitle: <span>{work?.title ?? \"Unknown\"}</span>\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\tFirst published: <span>{work?.first_publish_date ?? \"Unknown\"} </span>\r\n\t\t\t</p>\r\n\t\t\t{/* <p>\r\n\t\t\t\tDescription: <span>{work?.description?.value ?? \"Unknown\"}</span>\r\n\t\t\t</p> */}\r\n\t\t\t{covers ? (\r\n\t\t\t\t<img\r\n\t\t\t\t\tclassName=\"image\"\r\n\t\t\t\t\tsrc={`https://covers.openlibrary.org/b/id/${covers[0]}-M.jpg`}\r\n\t\t\t\t/>\r\n\t\t\t) : (\r\n\t\t\t\t<p className=\"image\">No image available</p>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n};\r\n","import React, { useEffect, useState, useRef, useCallback } from \"react\";\r\nimport { HeadFC } from \"gatsby\";\r\nimport { Layout } from \"../../components/Layout\";\r\nimport { throttleFunction } from \"../../helpers/throttleFunction\";\r\nimport { BookCard } from \"../../components/BookCard\";\r\n\r\nconst tempUrl = \"http://openlibrary.org/search/authors.json?q=twain\";\r\nconst limit = \"&limit=50\";\r\nconst authorSearchURL = (term: string) =>\r\n\t`http://openlibrary.org/search/authors.json?q=${term}${limit}`;\r\nconst authorsBooksSearchURL = (key: string) =>\r\n\t`https://openlibrary.org/authors/${key}/works.json`;\r\nconst delay = 1500;\r\n\r\nconst debounceAndThrottle = () => {\r\n\tconst [authors, setAuthors] = useState<any>(null);\r\n\tconst [works, setWorks] = useState<any>(null);\r\n\tconst [countCalls, setCountCalls] = useState(0);\r\n\tconst searchRef = useRef<any>(null);\r\n\r\n\tconst ref = { countCalls };\r\n\tconst _ref = useRef(ref);\r\n\t_ref.current = ref;\r\n\r\n\tconst handleOnChange = useCallback(\r\n\t\tthrottleFunction(() => {\r\n\t\t\tif (searchRef && searchRef.current && searchRef.current?.value) {\r\n\t\t\t\tconst { countCalls } = _ref.current;\r\n\t\t\t\tsetCountCalls(countCalls + 1);\r\n\r\n\t\t\t\tconst searchTerm = searchRef.current?.value;\r\n\t\t\t\tconst url = authorSearchURL(searchTerm);\r\n\t\t\t\tfetchAllAuthors(url);\r\n\t\t\t}\r\n\t\t}, delay),\r\n\t\t[]\r\n\t);\r\n\r\n\tconst fetchAllAuthors = async (url: string) => {\r\n\t\tfetch(url)\r\n\t\t\t.then((resp) => resp.json())\r\n\t\t\t.then((json) => mutateAuthors(json))\r\n\t\t\t.then((mutatedauthors) => setAuthors(mutatedauthors));\r\n\t};\r\n\r\n\tconst fetchAuthorsBooks = async (url: string) => {\r\n\t\tfetch(url)\r\n\t\t\t.then((resp) => resp.json())\r\n\t\t\t.then((json) => setWorks(json));\r\n\t};\r\n\r\n\tconst handleAuthorClick = (keys: string[]) => {\r\n\t\tfor (let i = 0, n = keys.length; i < n; i++) {\r\n\t\t\tfetchAuthorsBooks(authorsBooksSearchURL(keys[i]));\r\n\t\t}\r\n\t\tsetAuthors(null);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<Layout className=\"garden__page debounce-throttle\">\r\n\t\t\t<p></p>\r\n\t\t\t<h3>API Call Count: {countCalls}</h3>\r\n\t\t\t<p className=\"debounce-throttle__description\">\r\n\t\t\t\tWhilst knowing the need and use of debounce and throttle, I haven't\r\n\t\t\t\tfound myself needing to implement either in the past. So I decided to\r\n\t\t\t\tstart looking into it myself and create this search. This uses\r\n\t\t\t\tthrottling on the input below so that calls are only sent per {delay}{\" \"}\r\n\t\t\t\tmilliseconds.\r\n\t\t\t\t<br />\r\n\t\t\t\t<br />\r\n\t\t\t\tOf course in the making of this I must have hit this API a good number\r\n\t\t\t\tof times...\r\n\t\t\t\t<br />\r\n\t\t\t\t<br />\r\n\t\t\t\tThis is incomplete at the moment, however in the theme of 'learning in\r\n\t\t\t\tpublic', posting online now seems like the way to go.\r\n\t\t\t\t<br />\r\n\t\t\t\t<br />\r\n\t\t\t\tAll API calls are thanks to{\" \"}\r\n\t\t\t\t<a href=\"https://openlibrary.org/developers/api\">Open Library</a>. They\r\n\t\t\t\thave simple documentation, easy to use, and truly great a resource.\r\n\t\t\t</p>\r\n\t\t\t<div className=\"search__panel\">\r\n\t\t\t\t<p>\r\n\t\t\t\t\tEnter author name <em>(exact matches only)</em>\r\n\t\t\t\t</p>\r\n\t\t\t\t<input\r\n\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\tref={searchRef}\r\n\t\t\t\t\tonChange={handleOnChange}\r\n\t\t\t\t\tclassName={`input search ${authors ? \"results\" : \"\"}`}\r\n\t\t\t\t\tonClick={handleOnChange}\r\n\t\t\t\t\tonBlur={() => setTimeout(() => setAuthors(null), 100)}\r\n\t\t\t\t/>\r\n\t\t\t\t{authors && (\r\n\t\t\t\t\t<ul className=\"search__result\">\r\n\t\t\t\t\t\t{Object.keys(authors).map((name: string, key: number) => {\r\n\t\t\t\t\t\t\tconst keys = authors[name];\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t<li key={key} onClick={() => handleAuthorClick(keys)}>\r\n\t\t\t\t\t\t\t\t\t{name}\r\n\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t\t</ul>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t\t{works && (\r\n\t\t\t\t<ul className=\"works__results\">\r\n\t\t\t\t\t{works?.entries &&\r\n\t\t\t\t\t\tworks.entries.map((work: any, key: number) => {\r\n\t\t\t\t\t\t\treturn <BookCard key={key} work={work}></BookCard>;\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t</ul>\r\n\t\t\t)}\r\n\t\t</Layout>\r\n\t);\r\n};\r\n\r\nexport default debounceAndThrottle;\r\n\r\nexport const Head: HeadFC = () => <title>Debounce and Throttle</title>;\r\n\r\n// Helpers\r\n\r\nconst mutateAuthors = (authors: any) => {\r\n\tconst docs = authors?.docs ?? null;\r\n\r\n\tif (!docs) return;\r\n\r\n\ttype AuthorObj = string[];\r\n\ttype UniqueAuthorsObj = { [key: string]: AuthorObj };\r\n\r\n\tconst uniqueAuthors: UniqueAuthorsObj = {};\r\n\tfor (let i = 0, n = docs.length; i < n; i++) {\r\n\t\tconst doc: { key: string; type: string; name: string } = docs[i];\r\n\t\tconst name = doc?.name ?? null;\r\n\t\tif (name && uniqueAuthors && uniqueAuthors[name]) {\r\n\t\t\tuniqueAuthors[doc.name].push(doc.key);\r\n\t\t} else {\r\n\t\t\tuniqueAuthors[doc.name] = [doc.key];\r\n\t\t}\r\n\t}\r\n\r\n\treturn uniqueAuthors;\r\n};\r\n","export const throttleFunction = (callBack: (e?: any) => any, delay = 1000) => {\r\n\tlet wait = false;\r\n\tlet waitingArgs: undefined | any;\r\n\r\n\tconst timeoutFunction = () => {\r\n\t\tif (waitingArgs == null) {\r\n\t\t\twait = false;\r\n\t\t} else {\r\n\t\t\tcallBack(...waitingArgs);\r\n\t\t\twaitingArgs = null;\r\n\t\t\tsetTimeout(timeoutFunction, delay);\r\n\t\t}\r\n\t};\r\n\r\n\tconsole.log(wait);\r\n\r\n\treturn (...args: any[]) => {\r\n\t\tif (wait) {\r\n\t\t\twaitingArgs = args;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tcallBack(...args);\r\n\t\twait = true;\r\n\t\tconsole.log({ wait, args, waitingArgs });\r\n\t\tsetTimeout(timeoutFunction, delay);\r\n\t};\r\n};\r\n"],"names":["BookCard","work","covers","React","className","title","first_publish_date","src","useState","authors","setAuthors","works","setWorks","countCalls","setCountCalls","searchRef","useRef","ref","_ref","current","handleOnChange","useCallback","callBack","delay","waitingArgs","wait","timeoutFunction","setTimeout","console","log","args","throttleFunction","_searchRef$current","value","searchTerm","_searchRef$current2","url","fetchAllAuthors","fetch","then","resp","json","mutateAuthors","mutatedauthors","fetchAuthorsBooks","Layout","href","type","onChange","onClick","onBlur","Object","keys","map","name","key","i","n","length","handleAuthorClick","entries","Head","docs","uniqueAuthors","doc","push"],"sourceRoot":""}